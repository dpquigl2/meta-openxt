tboot: measure all command line arguments (CVE-2014-5118)

JP Blake's patch to address CVE-2014-5118.

Upstream-status: This patch was submitted upstream, but tboot took a different
approach to fixing it.  However, their fix is currently incomplete:
http://sourceforge.net/p/tboot/mailman/message/32760688/

Reported-by: James Blake <blakej@ainfosec.com>
Signed-off-by: James Blake <blakej@ainfosec.com>
Signed-off-by: Chris Patterson <pattersonc@ainfosec.com>

diff -rupN tboot-1.7.0/tboot/common/policy.c tboot-1.7.0-patched/tboot/common/policy.c
--- tboot-1.7.0/tboot/common/policy.c	2012-01-15 10:21:20.000000000 -0500
+++ tboot-1.7.0-patched/tboot/common/policy.c	2014-11-07 12:11:02.966141513 -0500
@@ -383,8 +383,6 @@ static bool hash_module(tb_hash_t *hash,
     /* hash command line */
     if ( cmdline == NULL )
         cmdline = "";
-    else
-        cmdline = skip_filename(cmdline);
     if ( !hash_buffer((const unsigned char *)cmdline, strlen(cmdline), hash,
                       hash_alg) )
         return false;
